<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Chocolate Story üç´</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap');

        :root {
            --chocolate-dark: #3D2B1F;
            --chocolate-medium: #523A28;
            --warm-pink: #ffc1d4;
            --text-light: #f5f5f5;
            --gold: #FFD700;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #111;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        #app-container {
            width: 100vw;
            height: 100vh;
            max-width: 430px;
            max-height: 932px;
            background: var(--chocolate-dark);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
            transition: background-color 1s ease;
        }

        .scene {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            color: var(--text-light);
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transform: scale(1.05);
            transition: opacity 0.8s ease, transform 0.8s ease, visibility 0.8s;
        }

        .scene.active {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }

        /* --- Scene 0: Entry --- */
        .powder {
            position: absolute;
            background: var(--chocolate-medium);
            border-radius: 50%;
            opacity: 0.4;
            animation: float 25s infinite ease-in-out;
            pointer-events: none;
        }
        @keyframes float {
            0% { transform: translateY(0vh) translateX(0vw); opacity: 0; }
            25% { opacity: 0.4; }
            75% { opacity: 0.4; }
            100% { transform: translateY(-120vh) translateX(10vw) rotate(360deg); opacity: 0; }
        }

        #entry-text {
            font-size: 1.5rem;
            animation: pulse 3s infinite ease-in-out;
        }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }

        /* --- Scene 1 & 2: Dialogue --- */
        .character {
            font-size: 100px;
            position: relative;
        }
        .crown {
            position: absolute;
            top: -50px; left: 50%;
            transform: translateX(-50%) rotate(-15deg);
            font-size: 50px;
            animation: crown-pop 0.5s 1s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards;
            opacity: 0;
            transform-origin: bottom center;
        }
        @keyframes crown-pop {
            from { transform: translateX(-50%) rotate(-15deg) scale(0); opacity: 0; }
            to { transform: translateX(-50%) rotate(-15deg) scale(1); opacity: 1; }
        }
        #character-1.bounce-in { animation: bounce-in 0.8s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards; }
        @keyframes bounce-in {
            0% { transform: scale(0.5); opacity: 0; }
            60% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .dialogue-box {
            font-size: 1.6rem;
            margin-top: 20px;
            font-weight: 500;
            min-height: 150px;
            line-height: 1.4;
        }

        /* Dialogue Animations */
        .shake { animation: shake-anim 0.4s 1; }
        @keyframes shake-anim { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-3px, 0, 0); } 40%, 60% { transform: translate3d(3px, 0, 0); } }
        .zoom-dramatic { animation: zoom-dramatic-anim 0.5s forwards; }
        @keyframes zoom-dramatic-anim { to { transform: scale(1.4); } }
        
        #character-2.walk-off { animation: walk-off-anim 1s forwards ease-in; }
        @keyframes walk-off-anim { to { transform: translateX(200px) rotate(25deg); opacity: 0; } }

        /* --- Scene 3: Game --- */
        #game-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; width: 90%; max-width: 330px; }
        .hole { width: 90px; height: 90px; background: #2E1F14; border-radius: 50%; box-shadow: inset 0 6px 10px rgba(0,0,0,0.5); position: relative; }
        .hole .game-chocolate {
            font-size: 45px; position: absolute; bottom: 5px; left: 50%;
            transform: translateX(-50%) translateY(50px);
            user-select: none;
            visibility: hidden;
            transition: transform 0.1s;
        }
        .hole .game-chocolate.up { animation: popup 0.2s forwards; visibility: visible; }
        @keyframes popup { to { transform: translateX(-50%) translateY(0); } }
        .hole .game-chocolate.whacked { animation: whacked-anim 0.3s forwards; }
        @keyframes whacked-anim { 0% { transform: translateX(-50%) scale(1) rotate(0); } 50% { transform: translateX(-50%) scale(0.8) rotate(-15deg); } 100% { transform: translateX(-50%) translateY(50px) scale(0.5); } }

        #game-instructions { font-size: 1.2rem; margin-bottom: 20px; }
        #score-display { font-size: 1.5rem; margin-top: 20px; font-weight: bold; }
        #game-over-message { display: none; font-size: 2.2rem; font-weight: bold; }

        /* --- Scene 4-7: Cinematic --- */
        #scene-4.flash { animation: flash-anim 0.2s 2 ease-in-out; }
        @keyframes flash-anim { 50% { background: #eee; } }
        
        .drama-text { animation: fade-in-slow 2.5s forwards; opacity: 0; font-size: 1.8rem; margin: 10px 0;}
        .drama-text:nth-child(2) { animation-delay: 2s; }
        @keyframes fade-in-slow { to { opacity: 1; } }
        
        .reveal-container {
            font-size: 5rem;
            animation: walk-forward 4s cubic-bezier(0.25, 1, 0.5, 1) forwards;
            opacity: 0;
            display: flex;
            align-items: flex-end;
            gap: 15px;
        }
        .reveal-container span:first-child { font-size: 6rem; } /* Make Swikar emoji bigger */
        @keyframes walk-forward {
            from { transform: scale(0.4) translateY(150px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }
        
        .cinematic-dialogue { opacity: 0; animation: fade-in-slow 1.5s 4.5s forwards; margin-top: 20px; }
        .cinematic-dialogue p { margin: 5px 0; font-size: 1.2rem; line-height: 1.5; }
        
        .throne-character { font-size: 8rem; position: relative; }
        .throne-character .crown { animation: crown-drop 2.5s forwards 1s cubic-bezier(0.6, -0.28, 0.74, 0.05); }
        @keyframes crown-drop {
            0% { top: -60px; transform: translateX(-50%) rotate(-15deg); opacity: 1; }
            100% { top: 50px; transform: translateX(-50%) rotate(720deg) scale(0.2); opacity: 0; }
        }

        .final-chocolate { font-size: 8rem; position: relative; }
        #melt-heart {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; transform: scale(0.5);
            transition: opacity 1.5s 1.5s ease, transform 1.5s 1.5s ease;
        }
        #melt-chocolate { transition: opacity 1s 0.5s ease, transform 1s 0.5s ease; }
        .is-melting #melt-chocolate { opacity: 0; transform: scale(0.8) rotate(-15deg); }
        .is-melting #melt-heart { opacity: 1; transform: scale(1.1); }
        
        /* --- Scene 8: Final Message --- */
        .final-text { animation: fade-in-slow 2s forwards; }
        .final-text h1 { font-size: 2.2rem; margin-bottom: 20px; }
        .final-text p { font-size: 1.7rem; line-height: 1.6; margin: 2px 0; }

        .heart-particle {
            position: absolute;
            font-size: 1.5rem;
            animation: float-up 10s infinite linear;
            pointer-events: none;
            will-change: transform, opacity;
        }
        @keyframes float-up {
            from { transform: translateY(0vh) translateX(0vw) scale(1); opacity: 0.8; }
            to { transform: translateY(-120vh) translateX(5vw) scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>

    <div id="app-container">

        <!-- SCENE 0: LOADING / ENTRY -->
        <div id="scene-0" class="scene active">
            <p id="entry-text">Tap to enter‚Ä¶ if you dare. üòèüç´</p>
        </div>

        <!-- SCENE 1: THE ARROGANT CHOCOLATE ARRIVES -->
        <div id="scene-1" class="scene">
            <div id="character-1" class="character"><div class="crown">üëë</div>üç´</div>
            <div id="dialogue-1" class="dialogue-box"></div>
        </div>
        
        <!-- SCENE 2: HE TRASH TALKS YOU -->
        <div id="scene-2" class="scene">
            <div id="character-2" class="character">üç´</div>
            <div id="dialogue-2" class="dialogue-box"></div>
        </div>

        <!-- SCENE 3: WHACK-A-CHOCOLATE GAME -->
        <div id="scene-3" class="scene">
            <p id="game-instructions">Teach him a lesson. Tap the chocolate. üëäüç´</p>
            <div id="game-grid"></div>
            <p id="score-display">Hits: 0/5</p>
            <p id="game-over-message">OKAY OKAY STOPPP üòµ</p>
        </div>

        <!-- SCENE 4: CHAOS & DRAMA -->
        <div id="scene-4" class="scene">
            <p class="drama-text">Sometimes‚Ä¶</p>
            <p class="drama-text">Even the proudest melt.</p>
        </div>
        
        <!-- SCENE 5: CINEMATIC REVEAL -->
        <div id="scene-5" class="scene">
            <div class="reveal-container">
                <span>üòé<br/><p style="font-size:1.2rem; margin-top:-10px;">Swikar</p></span>
                <span>üç´</span>
            </div>
            <div id="dialogue-5" class="cinematic-dialogue"></div>
        </div>
        
        <!-- SCENE 6: THE THRONE IS GIVEN UP -->
        <div id="scene-6" class="scene">
            <div class="throne-character"><div class="crown">üëë</div>üç´</div>
            <div id="dialogue-6" class="dialogue-box"></div>
        </div>
        
        <!-- SCENE 7: THE MELT -->
        <div id="scene-7" class="scene">
             <div id="chocolate-melt-container" class="final-chocolate">
                 <span id="melt-chocolate">üç´</span>
                 <span id="melt-heart">‚ù§Ô∏è</span>
             </div>
             <div id="dialogue-7" class="dialogue-box" style="opacity:0; animation: fade-in-slow 1s 3s forwards;"></div>
        </div>
        
        <!-- SCENE 8: FINAL LOVE MESSAGE -->
        <div id="scene-8" class="scene">
            <div class="final-text">
                <h1>Happy Chocolate Day üç´‚ù§Ô∏è</h1>
                <p>To the most amazing,</p>
                <p>sweetest,</p>
                <p>adorable,</p>
                <p>cutest,</p>
                <p>my chocolate,</p>
                <p>my everything.</p>
                <br>
                <p><b>Happy Chocolate Day,‡§Æ‡•á‡§∞‡•Ä ‡§∏‡§æ‡§®‡•Å‚ù§Ô∏è üíï</b></p>
            </div>
        </div>

    </div>

    <script>
        const scenes = document.querySelectorAll('.scene');
        const appContainer = document.getElementById('app-container');
        let currentScene = 0;

        const el = (id) => document.getElementById(id);

        function showScene(sceneIndex) {
            scenes[currentScene].classList.remove('active');
            currentScene = sceneIndex;
            const newScene = scenes[currentScene];
            newScene.classList.add('active');

            // Apply specific background colors for scenes
            if (currentScene === 4) {
                appContainer.style.backgroundColor = '#1a1a1a';
            } else if (currentScene >= 7) {
                appContainer.style.backgroundColor = 'var(--warm-pink)';
            } else {
                appContainer.style.backgroundColor = 'var(--chocolate-dark)';
            }
            
            runSceneLogic(currentScene);
        }

        // --- DIALOGUE & TYPING ---
        function typeWriter(element, text, speed, onComplete) {
            let i = 0;
            element.innerHTML = "";
            const typing = () => {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(typing, speed);
                } else if (onComplete) {
                    setTimeout(onComplete, 500);
                }
            };
            typing();
        }

        function dialogueManager(sceneId, character, dialogueArray) {
            let dialogueIndex = 0;
            const sceneElement = el(`scene-${sceneId}`);
            const dialogueBox = el(`dialogue-${sceneId}`);

            const nextDialogue = () => {
                sceneElement.removeEventListener('click', nextDialogue); // Prevent multiple clicks
                if (dialogueIndex < dialogueArray.length) {
                    const line = dialogueArray[dialogueIndex];
                    if(character) {
                        character.className = "character"; // Reset animations
                        if (line.anim) character.classList.add(line.anim);
                    }
                    typeWriter(dialogueBox, line.text, 50, () => {
                         dialogueIndex++;
                         if(dialogueIndex < dialogueArray.length) {
                             sceneElement.addEventListener('click', nextDialogue);
                         } else {
                             line.onComplete(); // Call the final callback
                         }
                    });
                }
            };
            
            nextDialogue();
        }

        // --- SCENE LOGIC CONTROLLER ---
        function runSceneLogic(index) {
            switch(index) {
                case 0: // Entry
                    createParticles(el('scene-0'), 'powder', 5);
                    el('scene-0').onclick = () => showScene(1);
                    break;
                case 1: // Arrogant Chocolate
                    const character1 = el('character-1');
                    character1.classList.add('bounce-in');
                    dialogueManager(1, character1, [
                        { text: "Ohhh‚Ä¶ so YOU must be her. üòè" },
                        { text: "I‚Äôve heard a LOT about you." },
                        { text: "What was that guy‚Äôs name again‚Ä¶?" },
                        { text: "‚Ä¶Ahhh. Swikar. üòé" },
                        { text: "That guy is OBSESSED with you." },
                        { text: "Gentle this‚Ä¶ sweet that‚Ä¶ amazing blah blah blah üôÑ", anim: 'shake'},
                        { text: "But let me make one thing VERY clear.", anim: 'zoom-dramatic'},
                        { text: "I‚Äôm sweeter than you." },
                        { text: "I‚Äôm more loved than you." },
                        { text: "I‚Äôm adored by the ENTIRE WORLD. üåçüç´" },
                        { text: "People don‚Äôt choose chocolate." },
                        { text: "Chocolate chooses THEM.", onComplete: () => setTimeout(() => showScene(2), 1000) }
                    ]);
                    break;
                case 2: // Trash Talk
                    const character2 = el('character-2');
                    dialogueManager(2, character2, [
                         { text: "And that Swikar guy?" },
                         { text: "Pfft. Emotional. Dramatic." },
                         { text: "Acts tough but melts faster than me. üòå" },
                         { text: "She's the best in the world, blah, blah üòè" },
                         { text: "I am the best." },
                         { text: "I am the SWEETEST üç´. not YOU Miss AK. üòè", onComplete: () => {
                            character2.classList.add('walk-off');
                            setTimeout(() => showScene(3), 1200);
                         } }
                    ]);
                    break;
                case 3: // Whack-a-Chocolate Game
                    runGame();
                    break;
                case 4: // Drama
                    setTimeout(() => el('scene-4').classList.add('flash'), 2500);
                    setTimeout(() => showScene(5), 6000);
                    break;
                case 5: // Reveal
                    const dialogue5Box = el('dialogue-5');
                    const revealLines = [
                        "‚ÄúI have been taught a lesson by Mr. Swikar. I was wrong.‚Äù", "‚ÄúI am sorry. I thought I was the sweetest thing in this world‚Ä¶‚Äù", "‚ÄúBut then I really got to know you.‚Äù",
                        "‚ÄúYour kindness.‚Äù", "‚ÄúYour warmth.‚Äù", "‚ÄúYour Love for him.‚Äù", "‚ÄúYou are the best. Not me.‚Äù ü•π"
                    ];
                    let lineIdx = 0;
                    function showNextRevealLine() {
                        if(lineIdx < revealLines.length) {
                            const p = document.createElement('p');
                            p.innerHTML = revealLines[lineIdx++];
                            dialogue5Box.appendChild(p);
                            setTimeout(showNextRevealLine, 1800);
                        } else {
                            setTimeout(() => showScene(6), 2000);
                        }
                    }
                    setTimeout(showNextRevealLine, 5000);
                    break;
                case 6: // Throne Given Up
                    dialogueManager(6, null, [
                         { text: "I step down.", onComplete: () => {}},
                         { text: "The throne belongs to...", onComplete: () => {}},
                         { text: "The most adorable, loving, beautiful soul. YOU ‚ù§Ô∏è", onComplete: () => {}},
                         { text: "You. And only you ‚ù§Ô∏èü´°", onComplete: () => setTimeout(() => showScene(7), 2000) }
                    ]);
                    break;
                case 7: // Melt
                    el('chocolate-melt-container').classList.add('is-melting');
                    typeWriter(el('dialogue-7'), "Happy Chocolate Day‚Ä¶<br>My Queen. üëëüç´", 70, () => {
                        setTimeout(() => showScene(8), 2500);
                    });
                    break;
                case 8: // Final Message
                    createParticles(el('app-container'), 'heart', 20);
                    break;
            }
        }
        
        // --- GAME LOGIC ---
        function runGame() {
            const grid = el('game-grid');
            const scoreDisplay = el('score-display');
            grid.innerHTML = '';
            let score = 0;
            let speed = 1000;
            let currentTimeout;
            
            for(let i=0; i<9; i++){
                grid.innerHTML += `<div class="hole"><span class="game-chocolate">üç´</span></div>`;
            }

            const chocolates = document.querySelectorAll('.game-chocolate');

            chocolates.forEach(choc => {
                choc.addEventListener('mousedown', () => { // mousedown feels faster
                    if(choc.classList.contains('up') && !choc.classList.contains('whacked')) {
                        score++;
                        scoreDisplay.textContent = `Hits: ${score}/5`;
                        speed = Math.max(250, speed - 125);
                        
                        choc.classList.add('whacked');
                        choc.textContent = 'üòµ‚Äçüí´';
                        clearTimeout(currentTimeout);

                        if (score >= 5) {
                            endGame();
                        } else {
                            setTimeout(popChocolate, 400);
                        }
                    }
                });
            });

            function popChocolate() {
                chocolates.forEach(c => {
                    c.classList.remove('up', 'whacked');
                    c.textContent = 'üç´';
                });
                const randomIndex = Math.floor(Math.random() * chocolates.length);
                const activeChoc = chocolates[randomIndex];
                activeChoc.classList.add('up');
                
                currentTimeout = setTimeout(() => {
                    activeChoc.classList.remove('up');
                    popChocolate();
                }, speed);
            }
            
            function endGame() {
                chocolates.forEach(c => c.classList.remove('up'));
                el('game-grid').style.display = 'none';
                el('game-instructions').style.display = 'none';
                scoreDisplay.style.display = 'none';
                el('game-over-message').style.display = 'block';
                setTimeout(() => showScene(4), 2500);
            }

            popChocolate();
        }
        
        // --- PARTICLE EFFECT ---
        function createParticles(container, type, count) {
            for(let i = 0; i < count; i++) {
                const p = document.createElement('div');
                if (type === 'powder') {
                    p.classList.add('powder');
                    p.style.width = p.style.height = `${Math.random() * 15 + 5}px`;
                    p.style.animationDelay = `${Math.random() * 25}s`;
                } else { // Heart
                    p.classList.add('heart-particle');
                    p.innerHTML = '‚ù§Ô∏è';
                    p.style.fontSize = `${Math.random() * 1.5 + 0.8}rem`;
                    p.style.animationDelay = `${Math.random() * 10}s`;
                }
                p.style.left = `${Math.random() * 100}vw`;
                container.appendChild(p);
            }
        }
        
        // --- INITIALIZE ---
        showScene(0);

    </script>

</body>
</html>